<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIæƒ…è¯—ç”Ÿæˆå™¨ | æµªæ¼«ä»£ç æ”¶è—é¦†</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        :root {
            --primary: #9a7eb8;
            --primary-dark: #6d5b97;
            --secondary: #ff9a9e;
            --light: #f9f5ff;
            --dark: #4a4a68;
            --success: #6dccb0;
        }

        body {
            min-height: 100vh;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            background-attachment: fixed;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            color: var(--dark);
        }

        .floating-hearts {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
        }

        .heart {
            position: absolute;
            color: rgba(255, 154, 158, 0.5);
            font-size: 20px;
            animation: float 12s linear infinite;
            opacity: 0;
        }

        @keyframes float {
            0% {
                transform: translateY(100vh) rotate(0deg);
                opacity: 0;
            }
            10% {
                opacity: 1;
            }
            90% {
                opacity: 1;
            }
            100% {
                transform: translateY(-50px) rotate(360deg);
                opacity: 0;
            }
        }

        .container {
            width: 100%;
            max-width: 900px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 15px 50px rgba(109, 91, 151, 0.2);
            overflow: hidden;
            position: relative;
            z-index: 1;
            margin: 40px 0;
        }

        .header {
            background: linear-gradient(45deg, var(--primary), var(--primary-dark));
            color: white;
            padding: 30px 40px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: "";
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0) 70%);
            transform: rotate(30deg);
        }

        h1 {
            font-size: 2.8rem;
            margin-bottom: 10px;
            position: relative;
            text-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }

        .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
            max-width: 600px;
            margin: 0 auto;
            position: relative;
        }

        .flower {
            display: inline-block;
            animation: sway 3s ease-in-out infinite alternate;
            margin: 0 10px;
            font-size: 2rem;
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.2));
        }

        @keyframes sway {
            0% { transform: rotate(-10deg); }
            100% { transform: rotate(10deg); }
        }

        .content {
            padding: 40px;
        }

        .control-panel {
            background: var(--light);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }

        .panel-title {
            color: var(--primary-dark);
            margin-bottom: 20px;
            font-size: 1.4rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .panel-title i {
            font-size: 1.8rem;
        }

        .input-group {
            margin-bottom: 25px;
        }

        label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: var(--dark);
            font-size: 1.1rem;
        }

        .keywords-input {
            width: 100%;
            padding: 16px 20px;
            border: 2px solid #e0d6eb;
            border-radius: 12px;
            font-size: 1.1rem;
            transition: all 0.3s;
            background: white;
            box-shadow: inset 0 2px 5px rgba(0,0,0,0.05);
        }

        .keywords-input:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(154, 126, 184, 0.3);
        }

        .suggestions {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 12px;
        }

        .suggestion {
            background: rgba(154, 126, 184, 0.1);
            color: var(--primary-dark);
            border: 1px solid rgba(154, 126, 184, 0.3);
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 0.95rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .suggestion:hover {
            background: var(--primary);
            color: white;
            transform: translateY(-2px);
        }

        .options-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 25px;
        }

        .option {
            background: white;
            border-radius: 12px;
            padding: 18px;
            border: 2px solid #e8e4f2;
            transition: all 0.3s;
            cursor: pointer;
            text-align: center;
            box-shadow: 0 3px 10px rgba(0,0,0,0.03);
        }

        .option:hover {
            transform: translateY(-5px);
            border-color: var(--primary);
            box-shadow: 0 5px 15px rgba(154, 126, 184, 0.2);
        }

        .option i {
            font-size: 2.5rem;
            color: var(--primary);
            margin-bottom: 15px;
        }

        .option h3 {
            color: var(--primary-dark);
            margin-bottom: 8px;
            font-size: 1.2rem;
        }

        .option p {
            font-size: 0.95rem;
            color: #777;
        }

        .option.active {
            background: rgba(154, 126, 184, 0.1);
            border-color: var(--primary);
            transform: translateY(-5px);
        }

        .generate-btn {
            display: block;
            width: 100%;
            background: linear-gradient(45deg, var(--primary), var(--primary-dark));
            color: white;
            border: none;
            padding: 18px;
            font-size: 1.2rem;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 5px 15px rgba(109, 91, 151, 0.4);
            font-weight: 600;
            letter-spacing: 1px;
            margin-top: 30px;
            position: relative;
            overflow: hidden;
        }

        .generate-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(109, 91, 151, 0.5);
        }

        .generate-btn:active {
            transform: translateY(1px);
        }

        .generate-btn::after {
            content: "";
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: all 0.5s;
        }

        .generate-btn:hover::after {
            left: 100%;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 30px;
            margin: 20px 0;
            font-style: italic;
            color: var(--dark);
            font-size: 1.2rem;
        }

        .loading:after {
            content: '...';
            animation: dots 1.5s steps(5, end) infinite;
        }

        @keyframes dots {
            0%, 20% { content: '.'; }
            40% { content: '..'; }
            60%, 100% { content: '...'; }
        }

        .poem-container {
            background: var(--light);
            border-radius: 15px;
            padding: 40px;
            margin-top: 20px;
            border-left: 5px solid var(--primary);
            display: none;
            animation: fadeIn 0.8s ease-out;
            position: relative;
            overflow: hidden;
        }

        .poem-container::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><path fill="rgba(154, 126, 184, 0.03)" d="M20,20 Q40,5 50,30 T80,20" /></svg>');
            background-size: 150px;
            opacity: 0.2;
            z-index: 0;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .poem-title {
            color: var(--primary-dark);
            font-size: 1.8rem;
            margin-bottom: 25px;
            text-align: center;
            font-weight: 700;
            position: relative;
            z-index: 1;
        }

        .poem-content {
            line-height: 1.8;
            font-size: 1.3rem;
            white-space: pre-line;
            text-align: center;
            position: relative;
            z-index: 1;
            font-family: 'Georgia', serif;
            color: #4a4a68;
        }

        .poem-actions {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 30px;
            position: relative;
            z-index: 1;
        }

        .action-btn {
            padding: 12px 25px;
            border-radius: 50px;
            border: none;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .action-btn i {
            font-size: 1.2rem;
        }

        .regenerate-btn {
            background: var(--primary);
            color: white;
        }

        .regenerate-btn:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
        }

        .share-btn {
            background: #ff9a9e;
            color: white;
        }

        .share-btn:hover {
            background: #ff7a80;
            transform: translateY(-2px);
        }

        .save-btn {
            background: var(--success);
            color: white;
        }

        .save-btn:hover {
            background: #4caf50;
            transform: translateY(-2px);
        }

        .history-container {
            margin-top: 40px;
            display: none;
        }

        .history-title {
            color: var(--primary-dark);
            font-size: 1.4rem;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .history-list {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            max-height: 300px;
            overflow-y: auto;
        }

        .history-item {
            padding: 15px;
            border-bottom: 1px solid #eee;
            cursor: pointer;
            transition: all 0.2s;
        }

        .history-item:hover {
            background: var(--light);
            transform: translateX(5px);
        }

        .history-item:last-child {
            border-bottom: none;
        }

        .history-item h4 {
            color: var(--primary-dark);
            margin-bottom: 5px;
        }

        .history-item p {
            color: #777;
            font-size: 0.9rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 30px 40px 25px;
            border-top: 1px solid #eee;
            margin-top: 20px;
        }

        .back-link {
            color: var(--primary-dark);
            text-decoration: none;
            font-weight: 600;
            padding: 10px 20px;
            border-radius: 50px;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .back-link:hover {
            background: rgba(109, 91, 151, 0.1);
            text-decoration: none;
        }

        .copyright {
            color: #777;
            font-size: 0.9rem;
        }

        @media (max-width: 768px) {
            .container {
                margin: 20px 0;
            }
            
            .header {
                padding: 20px;
            }
            
            h1 {
                font-size: 2.2rem;
            }
            
            .content {
                padding: 25px;
            }
            
            .options-grid {
                grid-template-columns: 1fr;
            }
            
            .poem-content {
                font-size: 1.1rem;
            }
            
            .footer {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }
        }
    </style>
</head>
<body>
    <!-- åŠ¨æ€èƒŒæ™¯ -->
    <div class="floating-hearts" id="floatingHearts"></div>

    <div class="container">
        <div class="header">
            <h1>AIæƒ…è¯—ç”Ÿæˆå™¨ <span class="flower">ğŸŒ¹</span></h1>
            <p class="subtitle">è¾“å…¥å…³é”®è¯ï¼Œé€‰æ‹©é£æ ¼ï¼Œç”Ÿæˆä¸“å±ä½ çš„æµªæ¼«æƒ…è¯—</p>
        </div>
        
        <div class="content">
            <div class="control-panel">
                <div class="panel-title">
                    <i class="fas fa-heart"></i>
                    <h2>åˆ›ä½œä½ çš„æƒ…è¯—</h2>
                </div>
                
                <div class="input-group">
                    <label for="keywords">è¾“å…¥å…³é”®è¯ï¼ˆç”¨ç©ºæ ¼æˆ–é€—å·åˆ†éš”ï¼‰</label>
                    <input type="text" class="keywords-input" id="keywords" placeholder="ä¾‹å¦‚: æµ·è¾¹ æ˜Ÿç©º åˆå» å’–å•¡">
                    
                    <div class="suggestions">
                        <div class="suggestion" data-keyword="æœˆå…‰">æœˆå…‰</div>
                        <div class="suggestion" data-keyword="ç«ç‘°">ç«ç‘°</div>
                        <div class="suggestion" data-keyword="å¾®é£">å¾®é£</div>
                        <div class="suggestion" data-keyword="ç›¸é‡">ç›¸é‡</div>
                        <div class="suggestion" data-keyword="æ°¸æ’">æ°¸æ’</div>
                    </div>
                </div>
                
                <div class="input-group">
                    <label>é€‰æ‹©è¯—æ­Œé£æ ¼</label>
                    <div class="options-grid">
                        <div class="option active" data-style="classic">
                            <i class="fas fa-feather"></i>
                            <h3>å¤å…¸æµªæ¼«</h3>
                            <p>å…¸é›…å«è“„ï¼Œå¯Œæœ‰è¯—æ„</p>
                        </div>
                        <div class="option" data-style="modern">
                            <i class="fas fa-pen-fancy"></i>
                            <h3>ç°ä»£è¯—æ„</h3>
                            <p>ç®€æ´è‡ªç”±ï¼Œæƒ…æ„ŸçœŸæŒš</p>
                        </div>
                        <div class="option" data-style="deep">
                            <i class="fas fa-moon"></i>
                            <h3>æ·±æƒ…æ¬¾æ¬¾</h3>
                            <p>æƒ…æ„Ÿæ·±é‚ƒï¼Œè¡¨è¾¾æµ“çƒˆ</p>
                        </div>
                    </div>
                </div>
                
                <div class="input-group">
                    <label>é€‰æ‹©è¯—æ­Œé•¿åº¦</label>
                    <div class="options-grid">
                        <div class="option active" data-length="short">
                            <i class="fas fa-align-left"></i>
                            <h3>çŸ­è¯—</h3>
                            <p>4-6è¡Œï¼Œç®€æ´æœ‰åŠ›</p>
                        </div>
                        <div class="option" data-length="medium">
                            <i class="fas fa-align-center"></i>
                            <h3>ä¸­è¯—</h3>
                            <p>8-10è¡Œï¼Œæƒ…æ„Ÿä¸°å¯Œ</p>
                        </div>
                        <div class="option" data-length="long">
                            <i class="fas fa-align-justify"></i>
                            <h3>é•¿è¯—</h3>
                            <p>12è¡Œä»¥ä¸Šï¼Œå®Œæ•´å™äº‹</p>
                        </div>
                    </div>
                </div>
                
                <button class="generate-btn" id="generateBtn">
                    <i class="fas fa-magic"></i> ç”Ÿæˆæµªæ¼«æƒ…è¯—
                </button>
            </div>
            
            <div class="loading" id="loading">AIæ­£åœ¨åˆ›ä½œä¸­ï¼Œè¯·ç¨å€™</div>
            
            <div class="poem-container" id="poemContainer">
                <div class="poem-title" id="poemTitle"></div>
                <div class="poem-content" id="poemContent"></div>
                <div class="poem-actions">
                    <button class="action-btn regenerate-btn" id="regenerateBtn">
                        <i class="fas fa-redo"></i> é‡æ–°ç”Ÿæˆ
                    </button>
                    <button class="action-btn share-btn">
                        <i class="fas fa-share-alt"></i> åˆ†äº«
                    </button>
                    <button class="action-btn save-btn">
                        <i class="fas fa-bookmark"></i> ä¿å­˜
                    </button>
                </div>
            </div>
            
            <div class="history-container" id="historyContainer">
                <div class="history-title">
                    <i class="fas fa-history"></i>
                    <h2>å†å²åˆ›ä½œ</h2>
                </div>
                <div class="history-list" id="historyList">
                    <!-- å†å²è®°å½•å°†é€šè¿‡JSåŠ¨æ€ç”Ÿæˆ -->
                </div>
            </div>
        </div>
        
        <div class="footer">
            <a href="../index.html" class="back-link">
                <i class="fas fa-arrow-left"></i> è¿”å›æµªæ¼«ä»£ç æ”¶è—é¦†
            </a>
            <p class="copyright">Â© 2023 AIæƒ…è¯—ç”Ÿæˆå™¨ | ç”¨ä»£ç ä¼ é€’æµªæ¼«</p>
        </div>
    </div>
    
    <script>
        // åˆ›å»ºåŠ¨æ€èƒŒæ™¯
        function createHearts() {
            const container = document.getElementById('floatingHearts');
            const heartCount = 20;
            
            for (let i = 0; i < heartCount; i++) {
                const heart = document.createElement('div');
                heart.classList.add('heart');
                heart.innerHTML = 'â¤';
                heart.style.left = Math.random() * 100 + 'vw';
                heart.style.animationDelay = Math.random() * 10 + 's';
                heart.style.fontSize = (Math.random() * 15 + 15) + 'px';
                container.appendChild(heart);
            }
        }
        
        // æƒ…è¯—æ¨¡æ¿åº“ï¼ˆæ‰©å±•ï¼‰
        const poemTemplates = {
            classic: [
                {
                    title: "ã€Š{keyword1}ä¹‹æ‹ã€‹",
                    content: `åœ¨{keyword1}çš„å¤œæ™šï¼Œ
{keyword2}è½»æ‹‚è¿‡ä½ çš„å‘æ¢¢ï¼Œ
{keyword3}æ˜ ç…§ç€ä½ çš„çœ¼çœ¸ï¼Œ
æˆ‘å¬è§{keyword4}åœ¨è¯‰è¯´ï¼Œ
é‚£{keyword5}çš„çˆ±æ‹ã€‚`
                },
                {
                    title: "ã€Š{keyword1}çš„æ€å¿µã€‹",
                    content: `å¿†å¾€æ˜”{keyword1}ï¼Œ
{keyword2}å¦‚ä½ èˆ¬æ¸©æŸ”ï¼Œ
{keyword3}ä¼¼ä½ çœ¼çœ¸é—ªçƒï¼Œ
{keyword4}è§è¯æˆ‘ä»¬çš„èª“è¨€ï¼Œ
{keyword5}æ˜¯æ°¸æ’çš„å°è®°ã€‚`
                },
                {
                    title: "ã€Š{keyword1}ä¹‹çº¦ã€‹",
                    content: `è‹¥{keyword1}èƒ½æ‡‚æˆ‘çš„å¿ƒï¼Œ
{keyword2}ä¼šä¼ è¾¾æˆ‘çš„æƒ…ï¼Œ
åœ¨{keyword3}çš„è§è¯ä¸‹ï¼Œ
è®¸ä¸‹{keyword4}çš„è¯ºè¨€ï¼Œ
å…±èµ´{keyword5}çš„æ—…ç¨‹ã€‚`
                }
            ],
            modern: [
                {
                    title: "{keyword1}ä¸{keyword2}",
                    content: `ä½ æ˜¯æˆ‘{keyword1}çš„{keyword2}ï¼Œ
åœ¨{keyword3}çš„æ—¥å­é‡Œï¼Œ
å¸¦ç»™æˆ‘{keyword4}çš„æ¸©æš–ï¼Œ
å¦‚åŒ{keyword5}èˆ¬æ°¸æ’ã€‚`
                },
                {
                    title: "è‡´{keyword1}çš„ä½ ",
                    content: `åœ¨{keyword1}çš„å­£èŠ‚é‡è§ä½ ï¼Œ
{keyword2}è®°å½•æˆ‘ä»¬çš„æ•…äº‹ï¼Œ
{keyword3}è½»æŠšè¿‡ä½ çš„ç¬‘å®¹ï¼Œ
{keyword4}æ˜¯æˆ‘å¿ƒè·³çš„èŠ‚å¥ï¼Œ
{keyword5}æ˜¯æˆ‘ä»¬çˆ±çš„è§è¯ã€‚`
                }
            ],
            deep: [
                {
                    title: "ã€Š{keyword1}çš„æ°¸æ’ã€‹",
                    content: `ä½ çš„{keyword1}è®©æˆ‘æ²‰é†‰ï¼Œ
å¦‚{keyword2}èˆ¬ä»¤äººç¥å¾€ï¼Œ
åœ¨{keyword3}çš„å¤œæ™šé‡Œï¼Œ
{keyword4}è¯‰è¯´ç€æˆ‘çš„å¿ƒå£°ï¼Œ
{keyword5}æ˜¯æˆ‘ä»¬çˆ±çš„å¯†ç ã€‚`
                },
                {
                    title: "{keyword1}çš„æ—‹å¾‹",
                    content: `{keyword1}æ˜¯ä½ çœ¼ä¸­çš„å…‰èŠ’ï¼Œ
{keyword2}æ˜¯ä½ å”‡è§’çš„æ¸©æŸ”ï¼Œ
{keyword3}æ˜¯æˆ‘ä»¬ç›¸é‡çš„åºæ›²ï¼Œ
{keyword4}æ˜¯ç›¸å®ˆçš„èª“è¨€ï¼Œ
{keyword5}æ˜¯æ°¸æ’çš„ç»ˆç« ã€‚`
                }
            ]
        };

        // æ‰©å±•æµªæ¼«è¯æ±‡åº“
        const romanticWords = {
            nature: ["æœˆå…‰", "æ˜Ÿè¾°", "å¤•é˜³", "æ™¨æ›¦", "å½©è™¹", "å¤§æµ·", "æ£®æ—", "å¾®é£", "ç»†é›¨", "é›ªèŠ±"],
            feeling: ["æ¸©æŸ”", "ç”œèœœ", "çƒ­çƒˆ", "æ°¸æ’", "å”¯ä¸€", "ç¼ ç»µ", "çœ·æ‹", "æ‚¸åŠ¨", "æ²‰é†‰", "ç‚½çƒ­"],
            body: ["çœ¼çœ¸", "å¾®ç¬‘", "å‘æ¢¢", "å¿ƒè·³", "å‘¼å¸", "æŒ‡å°–", "æ€€æŠ±", "è€³è¯­", "èƒŒå½±", "æŒå¿ƒ"],
            object: ["ç«ç‘°", "ä¿¡ä»¶", "å’–å•¡", "æ—¥è®°", "ç›¸å†Œ", "æˆ’æŒ‡", "çƒ›å…‰", "ç…§ç‰‡", "ä¹¦é¡µ", "å‰ä»–"],
            time: ["æ¸…æ™¨", "é»„æ˜", "åˆå¤œ", "æ˜¥å¤©", "å¤å¤©", "ç§‹å¤©", "å†¬å¤©", "å¹´å°‘", "é›¨å­£", "é›ªå¤œ"],
            abstract: ["ç¼˜åˆ†", "å‘½è¿", "æ—¶å…‰", "å›å¿†", "æ¢¦å¢ƒ", "æ°¸æ’", "ç¬é—´", "è¿œæ–¹", "è¯ºè¨€", "ç­‰å¾…"]
        };
        
        // å½“å‰ç”Ÿæˆè®¾ç½®
        let currentSettings = {
            style: 'classic',
            length: 'short'
        };
        
        // å†å²è®°å½•
        let history = JSON.parse(localStorage.getItem('poemHistory')) || [];
        
        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            createHearts();
            updateHistoryList();
            
            // è®¾ç½®é€‰é¡¹ç‚¹å‡»äº‹ä»¶
            document.querySelectorAll('.option').forEach(option => {
                option.addEventListener('click', function() {
                    // ç§»é™¤åŒç»„ä¸­çš„activeç±»
                    const group = this.parentElement;
                    group.querySelectorAll('.option').forEach(el => el.classList.remove('active'));
                    
                    // æ·»åŠ activeç±»
                    this.classList.add('active');
                    
                    // æ›´æ–°è®¾ç½®
                    if (this.dataset.style) {
                        currentSettings.style = this.dataset.style;
                    } else if (this.dataset.length) {
                        currentSettings.length = this.dataset.length;
                    }
                });
            });
            
            // å…³é”®è¯å»ºè®®ç‚¹å‡»äº‹ä»¶
            document.querySelectorAll('.suggestion').forEach(suggestion => {
                suggestion.addEventListener('click', function() {
                    const keyword = this.dataset.keyword;
                    const input = document.getElementById('keywords');
                    input.value = input.value ? input.value + ' ' + keyword : keyword;
                });
            });
            
            // ç”ŸæˆæŒ‰é’®äº‹ä»¶
            document.getElementById('generateBtn').addEventListener('click', generatePoem);
            
            // é‡æ–°ç”ŸæˆæŒ‰é’®äº‹ä»¶
            document.getElementById('regenerateBtn').addEventListener('click', generatePoem);
            
            // æŒ‰å›è½¦é”®ä¹Ÿå¯ä»¥ç”Ÿæˆæƒ…è¯—
            document.getElementById('keywords').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    generatePoem();
                }
            });
        });
        
        // ç”Ÿæˆæƒ…è¯—
        function generatePoem() {
            const keywordsInput = document.getElementById('keywords').value.trim();
            
            // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
            document.getElementById('loading').style.display = 'block';
            document.getElementById('poemContainer').style.display = 'none';
            document.getElementById('historyContainer').style.display = 'none';
            
            // æ¨¡æ‹ŸAIæ€è€ƒæ—¶é—´
            setTimeout(() => {
                const keywords = keywordsInput ? 
                    keywordsInput.split(/[ ,ï¼Œã€]+/).filter(word => word.length > 0) : [];
                
                // ç¡®ä¿æœ‰è¶³å¤Ÿçš„å…³é”®è¯ï¼Œä¸è¶³åˆ™ç”¨æµªæ¼«è¯æ±‡è¡¥å……
                const allKeywords = [];
                const categories = Object.keys(romanticWords);
                
                for (let i = 0; i < 5; i++) {
                    if (keywords[i]) {
                        allKeywords.push(keywords[i]);
                    } else {
                        const randomCategory = categories[Math.floor(Math.random() * categories.length)];
                        const words = romanticWords[randomCategory];
                        const randomWord = words[Math.floor(Math.random() * words.length)];
                        allKeywords.push(randomWord);
                    }
                }
                
                // æ ¹æ®å½“å‰é£æ ¼é€‰æ‹©æ¨¡æ¿
                const styleTemplates = poemTemplates[currentSettings.style];
                const template = styleTemplates[Math.floor(Math.random() * styleTemplates.length)];
                
                // æ›¿æ¢å…³é”®è¯
                let title = template.title;
                let content = template.content;
                
                for (let i = 1; i <= 5; i++) {
                    const placeholder = `{keyword${i}}`;
                    title = title.replace(placeholder, allKeywords[i-1]);
                    content = content.replace(placeholder, allKeywords[i-1]);
                }
                
                // æ ¹æ®é•¿åº¦è°ƒæ•´å†…å®¹
                if (currentSettings.length === 'short') {
                    content = content.split('\n').slice(0, 4).join('\n');
                } else if (currentSettings.length === 'long') {
                    // æ·»åŠ é¢å¤–è¯—å¥
                    const extraLines = [
                        `åœ¨è¿™${allKeywords[0]}çš„æ—¶åˆ»ï¼Œ`,
                        `æˆ‘çš„å¿ƒä¸ºä½ è€Œ${allKeywords[3]}ï¼Œ`,
                        `å¦‚åŒ${allKeywords[2]}èˆ¬çº¯å‡€ï¼Œ`,
                        `åœ¨${allKeywords[4]}çš„è§è¯ä¸‹ï¼Œ`,
                        `æˆ‘ä»¬çš„çˆ±æ°¸ä¸æ­¢æ¯ã€‚`
                    ];
                    content += '\n\n' + extraLines.join('\n');
                }
                
                // æ˜¾ç¤ºç”Ÿæˆçš„æƒ…è¯—
                document.getElementById('poemTitle').textContent = title;
                document.getElementById('poemContent').textContent = content;
                
                // æ·»åŠ åˆ°å†å²è®°å½•
                const poem = {
                    title: title,
                    content: content,
                    keywords: allKeywords,
                    style: currentSettings.style,
                    date: new Date().toLocaleString()
                };
                
                history.unshift(poem);
                if (history.length > 10) history.pop();
                localStorage.setItem('poemHistory', JSON.stringify(history));
                
                // éšè—åŠ è½½çŠ¶æ€ï¼Œæ˜¾ç¤ºæƒ…è¯—
                document.getElementById('loading').style.display = 'none';
                document.getElementById('poemContainer').style.display = 'block';
                document.getElementById('historyContainer').style.display = 'block';
                
                updateHistoryList();
                
            }, 1200); // æ¨¡æ‹ŸAIç”Ÿæˆæ—¶é—´
        }
        
        // æ›´æ–°å†å²è®°å½•åˆ—è¡¨
        function updateHistoryList() {
            const historyList = document.getElementById('historyList');
            historyList.innerHTML = '';
            
            if (history.length === 0) {
                historyList.innerHTML = '<div class="history-item"><p>æš‚æ— å†å²è®°å½•ï¼Œç”Ÿæˆä½ çš„ç¬¬ä¸€é¦–æƒ…è¯—å§ï¼</p></div>';
                return;
            }
            
            history.forEach((poem, index) => {
                const item = document.createElement('div');
                item.classList.add('history-item');
                item.innerHTML = `
                    <h4>${poem.title}</h4>
                    <p>å…³é”®è¯: ${poem.keywords.slice(0, 3).join(', ')}... | ${poem.date}</p>
                `;
                
                item.addEventListener('click', function() {
                    document.getElementById('poemTitle').textContent = poem.title;
                    document.getElementById('poemContent').textContent = poem.content;
                    document.getElementById('poemContainer').style.display = 'block';
                });
                
                historyList.appendChild(item);
            });
        }
    </script>
</body>
</html>